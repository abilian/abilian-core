language: python
python:
  - "2.7"

services:
  - redis-server

# Install dependencies
before_install:
 - sudo rm -rf /dev/shm && sudo ln -s /run/shm /dev/shm
 - sudo apt-add-repository -y ppa:chris-lea/node.js
 - sudo apt-get update
 - sudo apt-get install -y poppler-utils
 - sudo apt-get install npm
 - sudo npm install -g less

# Install Python dependencies
install:
  - pip install pip==1.4.1
  - pip install -r etc/deps-frozen.txt --use-mirrors
  - pip install -r etc/deps-devel.txt --use-mirrors

# Run tests
script:
  - py.test --tb=short -q --cov abilian --cov-report term-missing abilian tests
  - sphinx-build -W -b html docs/ docs/_build/

after_success:
  - coveralls
