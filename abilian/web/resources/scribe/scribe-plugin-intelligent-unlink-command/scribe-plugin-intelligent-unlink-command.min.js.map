{"version":3,"file":"scribe-plugin-intelligent-unlink-command.min.js","mappings":"AAAAA,OAAA,8CAAA,WASA,MAAA,YACA,MAAA,UAAAC,GACA,GAAAC,GAAAD,EAAAC,QAEAC,EAAA,GAAAF,GAAAG,IAAAC,QAAA,SAEAF,GAAAG,QAAA,WACA,GAAAC,GAAA,GAAAN,GAAAG,IAAAI,SAEAD,GAAAA,UAAAE,YACAR,EAAAS,mBAAAC,IAAA,WAKA,GAAAC,GAAAL,EAAAM,cAAA,SAAAC,GACA,MAAA,MAAAA,EAAAC,UAGAH,KAGAL,EAAAS,eAGAd,EAAAe,OAAAL,EAAAM,WAAAN,GAGAL,EAAAY,mBAIAlB,EAAAG,IAAAC,QAAAe,UAAAd,QAAAe,MAAAC,KAAAC,YAIApB,EAAAqB,aAAA,WACA,GAAAjB,GAAA,GAAAN,GAAAG,IAAAI,SACA,OAAAD,GAAAA,UAAAE,cACAF,EAAAM,cAAA,SAAAC,GACA,MAAA,MAAAA,EAAAC,WAGAd,EAAAG,IAAAC,QAAAe,UAAAI,aAAAH,MAAAC,KAAAC,YAIAtB,EAAAwB,SAAAC,OAAAvB","sources":["../src/scribe-plugin-intelligent-unlink-command.js"],"sourcesContent":["define('scribe-plugin-intelligent-unlink-command',[], function () {\n\n  /**\n   * This plugin modifies the `unlink` command so that, when the user's\n   * selection is collapsed, remove the containing A.\n   */\n\n  'use strict';\n\n  return function () {\n    return function (scribe) {\n      var element = scribe.element;\n      \n      var unlinkCommand = new scribe.api.Command('unlink');\n\n      unlinkCommand.execute = function () {\n        var selection = new scribe.api.Selection();\n\n        if (selection.selection.isCollapsed) {\n          scribe.transactionManager.run(function () {\n            /**\n             * If the selection is collapsed, we can remove the containing anchor.\n             */\n\n            var aNode = selection.getContaining(function (node) {\n              return node.nodeName === 'A';\n            });\n\n            if (aNode) {\n              // we must save and then restore the selection because unwrapping\n              // the anchor loses the current selection\n              selection.placeMarkers();\n\n              // unwrap the A element's children, then remove it\n              element.unwrap(aNode.parentNode, aNode);\n\n              // finally restore selection to the initial position\n              selection.selectMarkers();\n            }\n          });\n        } else {\n          scribe.api.Command.prototype.execute.apply(this, arguments);\n        }\n      };\n\n      unlinkCommand.queryEnabled = function () {\n        var selection = new scribe.api.Selection();\n        if (selection.selection.isCollapsed) {\n          return !! selection.getContaining(function (node) {\n            return node.nodeName === 'A';\n          });\n        } else {\n          return scribe.api.Command.prototype.queryEnabled.apply(this, arguments);\n        }\n      };\n\n      scribe.commands.unlink = unlinkCommand;\n    };\n  };\n\n});\n\n"],"names":["define","scribe","element","unlinkCommand","api","Command","execute","selection","Selection","isCollapsed","transactionManager","run","aNode","getContaining","node","nodeName","placeMarkers","unwrap","parentNode","selectMarkers","prototype","apply","this","arguments","queryEnabled","commands","unlink"]}